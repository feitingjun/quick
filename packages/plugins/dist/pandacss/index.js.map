{"version":3,"sources":["../../src/pandacss/index.ts"],"sourcesContent":["import { resolve, join } from 'path'\nimport { existsSync } from 'fs'\nimport { loadConfigAndCreateContext, codegen } from '@pandacss/node'\nimport { definePlugin } from '@quick/core'\n\nconst configTml = (srcDir: string, outPath: string) =>\n  `\nimport { defineConfig } from '@pandacss/dev'\n\nexport default defineConfig({\n  preflight: true,\n  include: ['./${srcDir}/**/*.{js,jsx,ts,tsx}'],\n  exclude: ['.quick/**/*', 'node_modules'],\n  jsxFramework: 'react',\n  outdir: '${outPath}'\n})\n`.trim()\n\nconst postcssTml = `\nmodule.exports = {\n  plugins: {\n    '@pandacss/dev/postcss': {}\n  }\n}\n`.trim()\n\nconst generate = async (configPath: string) => {\n  const ctx = await loadConfigAndCreateContext({\n    configPath,\n    cwd: process.cwd()\n  })\n  await codegen(ctx)\n}\n\nexport default definePlugin({\n  setup: async ({ context: { srcDir }, addWatch, addFile }) => {\n    const pandacss = 'panda.config.ts'\n    const configPath = resolve(process.cwd(), pandacss)\n    const postcssPath = resolve(process.cwd(), 'postcss.config.cjs')\n    const outPath = '.quick/pandacss'\n    if (!existsSync(configPath)) {\n      addFile({\n        content: configTml(srcDir, outPath),\n        outPath: resolve(process.cwd(), configPath)\n      })\n    }\n    if (!existsSync(postcssPath)) {\n      addFile({\n        content: postcssTml,\n        outPath: resolve(process.cwd(), postcssPath)\n      })\n    }\n    // 生成pandacss文件\n    await generate(configPath)\n    addWatch((event, path) => {\n      // 配置文件变化时重新生成\n      if (path === configPath && (event === 'add' || event === 'change')) {\n        generate(configPath)\n      }\n    })\n  }\n})\n"],"mappings":";AAAA,SAAS,eAAqB;AAC9B,SAAS,kBAAkB;AAC3B,SAAS,4BAA4B,eAAe;AACpD,SAAS,oBAAoB;AAE7B,IAAM,YAAY,CAAC,QAAgB,YACjC;AAAA;AAAA;AAAA;AAAA;AAAA,iBAKe,MAAM;AAAA;AAAA;AAAA,aAGV,OAAO;AAAA;AAAA,EAElB,KAAK;AAEP,IAAM,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMjB,KAAK;AAEP,IAAM,WAAW,OAAO,eAAuB;AAC7C,QAAM,MAAM,MAAM,2BAA2B;AAAA,IAC3C;AAAA,IACA,KAAK,QAAQ,IAAI;AAAA,EACnB,CAAC;AACD,QAAM,QAAQ,GAAG;AACnB;AAEA,IAAO,mBAAQ,aAAa;AAAA,EAC1B,OAAO,OAAO,EAAE,SAAS,EAAE,OAAO,GAAG,UAAU,QAAQ,MAAM;AAC3D,UAAM,WAAW;AACjB,UAAM,aAAa,QAAQ,QAAQ,IAAI,GAAG,QAAQ;AAClD,UAAM,cAAc,QAAQ,QAAQ,IAAI,GAAG,oBAAoB;AAC/D,UAAM,UAAU;AAChB,QAAI,CAAC,WAAW,UAAU,GAAG;AAC3B,cAAQ;AAAA,QACN,SAAS,UAAU,QAAQ,OAAO;AAAA,QAClC,SAAS,QAAQ,QAAQ,IAAI,GAAG,UAAU;AAAA,MAC5C,CAAC;AAAA,IACH;AACA,QAAI,CAAC,WAAW,WAAW,GAAG;AAC5B,cAAQ;AAAA,QACN,SAAS;AAAA,QACT,SAAS,QAAQ,QAAQ,IAAI,GAAG,WAAW;AAAA,MAC7C,CAAC;AAAA,IACH;AAEA,UAAM,SAAS,UAAU;AACzB,aAAS,CAAC,OAAO,SAAS;AAExB,UAAI,SAAS,eAAe,UAAU,SAAS,UAAU,WAAW;AAClE,iBAAS,UAAU;AAAA,MACrB;AAAA,IACF,CAAC;AAAA,EACH;AACF,CAAC;","names":[]}