{"version":3,"sources":["../../../src/components/form/item.tsx","../../../src/components/form/error-list.tsx","../../../src/components/form/provider.tsx","../../../src/components/form/index.tsx","../../../src/components/button/index.tsx","../../../src/components/box/index.tsx","../../../src/utils/numbers.ts","../../../src/hooks/use-query.ts","../../../src/hooks/use-async-action.ts","../../../src/components/search/search.tsx"],"names":["styled","Form","AntdForm","AntdButton","_","useMemo","jsx","form"],"mappings":"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","file":"search.js","sourcesContent":["import { Form, type FormItemProps as AntdFormItemProps } from 'antd'\nimport { styled, type StyledComponent } from '@quick/cssinjs'\n\nconst StyledItem = styled(Form.Item) as StyledComponent<AntdFormItemProps>\ntype CompoundedComponent = typeof StyledItem & {\n  useStatus: typeof Form.Item.useStatus\n}\nconst Item = StyledItem as CompoundedComponent\nItem.useStatus = Form.Item.useStatus\n\nexport default Item\n","import { Form } from 'antd'\nimport { styled } from '@quick/cssinjs'\n\nconst ErrorList = styled(Form.ErrorList)\n\nexport default ErrorList\n","import { Form } from 'antd'\nimport { styled } from '@quick/cssinjs'\n\nconst Provider = styled(Form.Provider)\n\nexport default Provider\n","import { Form as AntdForm, type FormInstance, type FormProps as AntdFormProps } from 'antd'\nimport { styled, type StyledComponent } from '@quick/cssinjs'\nimport Item from './item'\nimport ErrorList from './error-list'\nimport Provider from './provider'\n\nconst { useForm, useFormInstance, useWatch } = AntdForm\n\nconst StyledForm = styled(AntdForm) as StyledComponent<AntdFormProps>\n\ntype CompoundedComponent = typeof StyledForm & {\n  Item: typeof Item\n  List: typeof AntdForm.List\n  ErrorList: typeof ErrorList\n  Provider: typeof Provider\n  useForm: typeof useForm\n  useFormInstance: typeof useFormInstance\n  useWatch: typeof useWatch\n}\n\nconst Form = StyledForm as CompoundedComponent\nForm.Item = Item\nForm.List = AntdForm.List\nForm.ErrorList = ErrorList\nForm.Provider = Provider\nForm.useForm = useForm\nForm.useFormInstance = useFormInstance\nForm.useWatch = useWatch\n\nexport type FormProps = React.ComponentProps<typeof StyledForm>\nexport type FormItemProps = React.ComponentProps<typeof Item>\nexport type FormListProps = React.ComponentProps<typeof AntdForm.List>\nexport type FormErrorListProps = React.ComponentProps<typeof ErrorList>\nexport type FormProviderProps = React.ComponentProps<typeof Provider>\nexport type { FormInstance }\n\nexport default Form\n","import type { ComponentProps } from 'react'\nimport { styled } from '@quick/cssinjs'\nimport { Button as AntdButton } from 'antd'\n\nconst Button = styled(AntdButton)\n\nexport type ButtonProps = ComponentProps<typeof Button>\n\nexport default Button\n","import type { ComponentProps } from 'react'\nimport { styled } from '@quick/cssinjs'\n\nconst StyledBox = styled('div')\n\nexport type BoxProps = ComponentProps<typeof StyledBox> & {\n  as?: keyof React.JSX.IntrinsicElements\n}\n\nconst Box = (props: BoxProps) => <StyledBox as={props.as} {...props} />\n\nexport default Box\n","import Bignumber from 'bignumber.js'\n\n/**千分位 */\nexport function thousands(num: number | string) {\n  if (!isNumber(num)) return num\n  const arr = String(num).split('.')\n  const intPart = arr[0].replace(/(\\d)(?=(\\d{3})+$)/g, '$1,')\n  return arr[1] ? `${intPart}.${arr[1]}` : intPart\n}\n\n/**小数保留n位 */\nexport function toFixed(num: number | string, n = 2) {\n  return new Bignumber(num).toFixed(n)\n}\n\n/**四舍五入 */\nexport function round(num: number | string, n = 2) {\n  return new Bignumber(num).decimalPlaces(n, Bignumber.ROUND_HALF_UP).toNumber()\n}\n\n/**小数不足n位补零 */\nexport function zerofill(num: number | string, n = 2) {\n  const [intPart, decPart = ''] = String(num).split('.')\n  if (decPart.length >= n) return num\n  const filledDec = decPart.padEnd(n, '0').slice(0, n)\n  return `${intPart}.${filledDec}`\n}\n\n/**数字转换为百分比模式 */\nexport function toPercent(num: number | string) {\n  return multiply(num, 100) + '%'\n}\n\n/**判断是否是数字 */\nexport function isNumber(num: any): num is number {\n  const n = new Bignumber(num)\n  return n.isFinite() && !n.isNaN()\n}\n\n/**乘法 */\nexport function multiply(a: number | string, b: number | string) {\n  return new Bignumber(a).times(b).toNumber()\n}\n\n/**除法 */\nexport function divide(a: number | string, b: number | string) {\n  return new Bignumber(a).div(b).toNumber()\n}\n\n/**加法 */\nexport function add(a: number | string, b: number | string) {\n  return new Bignumber(a).plus(b).toNumber()\n}\n\n/**减法 */\nexport function subtract(a: number | string, b: number | string) {\n  return new Bignumber(a).minus(b).toNumber()\n}\n\n/**取余 */\nexport function mod(a: number | string, b: number | string) {\n  return new Bignumber(a).mod(b).toNumber()\n}\n","import { useMemo } from 'react'\nimport { useSearchParams } from 'react-router'\nimport { isNumber } from '@/utils'\n\nexport default function useQuery() {\n  const [query] = useSearchParams()\n  return useMemo(\n    () =>\n      query.entries().reduce((acc, [key, value]) => {\n        if (value === 'undefined') {\n          acc[key] = undefined\n        } else if (value === 'null') {\n          acc[key] = null\n        }\n        // 避免数字长度超过16为转换精度丢失\n        else if (value.length <= 16 && isNumber(value)) {\n          acc[key] = Number(value)\n        }\n        // 以逗号分割的数组\n        else if (value.includes(',')) {\n          acc[key] = value.split(',').map(item => (isNumber(item) ? Number(item) : item))\n        } else {\n          acc[key] = value\n        }\n        return acc\n      }, {} as Record<string, any>),\n    [query]\n  )\n}\n","import { useActionState, startTransition } from 'react'\n\n/**\n * 为异步函数添加 loading，不接收函数返回值\n * @param dispatch 异步函数\n * @returns [action, loading]\n ** action 触发异步函数\n ** loading 异步函数是否执行中\n */\nexport default function useAsyncAction<T extends any = any>(\n  dispatch: (payload: T) => void | Promise<void>\n) {\n  const [_, action, loading] = useActionState<void, T>(\n    (_: void, payload: T) => dispatch(payload),\n    void 0\n  )\n  return [(values: T) => startTransition(() => action(values)), loading] as const\n}\n","import { isDayjs } from 'dayjs'\nimport { useCallback, useEffect, useMemo } from 'react'\nimport { SearchOutlined, RedoOutlined } from '@ant-design/icons'\nimport Form, { type FormProps } from '@/components/form'\nimport Button from '@/components/button'\nimport Box from '@/components/box'\nimport useQuery from '@/hooks/use-query'\nimport useAsyncAction from '@/hooks/use-async-action'\nimport { useTheme } from '@/theme'\n\nexport interface SearchProps extends FormProps {\n  okText?: React.ReactNode\n  resetText?: React.ReactNode\n  initLoad?: boolean\n  onSearch?: (values: Record<string, any>) => void | Promise<void>\n  onReset?: () => Promise<void> | void\n  colWidth?: number\n}\n\nexport default function Search({\n  children,\n  okText = '查询',\n  resetText = '重置',\n  initLoad,\n  onSearch,\n  onReset,\n  colWidth = 280,\n  size = 'middle',\n  form: externalForm,\n  initialValues,\n  ...props\n}: SearchProps) {\n  if (\n    Object.values(initialValues ?? {}).some(item =>\n      Array.isArray(item) ? item.some(i => isDayjs(i)) : isDayjs(item)\n    )\n  ) {\n    throw new Error('Search 不接收 dayjs 类型的初始值，请使用字符串格式化日期')\n  }\n  const [form] = Form.useForm(externalForm)\n  // 获取url参数\n  const query = useQuery()\n  const theme = useTheme()\n  // 控件高度\n  const height = useMemo(() => {\n    if (size === 'small') {\n      return theme.sizes.controlHeightSm\n    }\n    if (size === 'large') {\n      return theme.sizes.controlHeightLg\n    }\n    return theme.sizes.controlHeight\n  }, [theme, size])\n\n  const [onFinish, loading] = useAsyncAction<Record<string, any>>(async values => {\n    if (typeof onSearch === 'function') {\n      onSearch(values)\n    }\n  })\n\n  const onClear = useCallback(async () => {\n    form.resetFields()\n    if (typeof onReset === 'function') {\n      await onReset()\n    }\n    form.submit()\n  }, [form, onReset])\n\n  useEffect(() => {\n    form.setFieldsValue(query)\n    if (initLoad) {\n      form.submit()\n    }\n  }, [query, form, initLoad])\n\n  const btns = useMemo(() => {\n    return (\n      <Box\n        sx={{\n          position: 'absolute',\n          right: 4 * theme.space,\n          bottom: 4 * theme.space,\n          w: colWidth / 2,\n          display: 'flex',\n          justifyContent: 'space-between',\n          '.ant-btn': {\n            px: 2.5,\n            gap: 1\n          }\n        }}\n      >\n        <Button mr={2} onClick={onClear} icon={<RedoOutlined />}>\n          {resetText}\n        </Button>\n        <Button type='primary' htmlType='submit' loading={loading} icon={<SearchOutlined />}>\n          {okText}\n        </Button>\n      </Box>\n    )\n  }, [loading, onClear, okText, resetText, theme, colWidth])\n\n  return (\n    <Form\n      layout='inline'\n      size={size}\n      form={form}\n      onFinish={onFinish}\n      initialValues={initialValues}\n      preserve\n      sx={{\n        bg: 'bg',\n        mb: 2,\n        display: 'grid',\n        gridTemplateColumns: `repeat(auto-fill, minmax(${colWidth / 2}px, 1fr))`,\n        p: 4,\n        gap: 2.5,\n        position: 'relative',\n        _after: {\n          content: '\"\"',\n          height,\n          gridColumn: 'span 1'\n        },\n        '& > *': {\n          gridColumn: 'span 2',\n          mr: 0\n        },\n        '.ant-row': {\n          flexWrap: 'nowrap'\n        },\n        '.ant-input-number, .ant-input-select, .ant-picker': {\n          w: 1\n        }\n      }}\n      {...props}\n    >\n      {typeof children === 'function' ? (\n        (values, form) => {\n          return (\n            <>\n              {children(values, form)}\n              {btns}\n            </>\n          )\n        }\n      ) : (\n        <>\n          {children}\n          {btns}\n        </>\n      )}\n    </Form>\n  )\n}\n"]}