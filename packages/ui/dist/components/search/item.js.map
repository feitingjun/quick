{"version":3,"sources":["../../../src/utils/numbers.ts","../../../src/components/form/item.tsx","../../../src/components/form/error-list.tsx","../../../src/components/form/provider.tsx","../../../src/components/form/index.tsx","../../../src/components/search/item.tsx"],"names":["styled","Form","AntdForm","Item","props"],"mappings":"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","file":"item.js","sourcesContent":["import Bignumber from 'bignumber.js'\n\n/**千分位 */\nexport function thousands(num: number | string) {\n  if (!isNumber(num)) return num\n  const arr = String(num).split('.')\n  const intPart = arr[0].replace(/(\\d)(?=(\\d{3})+$)/g, '$1,')\n  return arr[1] ? `${intPart}.${arr[1]}` : intPart\n}\n\n/**小数保留n位 */\nexport function toFixed(num: number | string, n = 2) {\n  return new Bignumber(num).toFixed(n)\n}\n\n/**四舍五入 */\nexport function round(num: number | string, n = 2) {\n  return new Bignumber(num).decimalPlaces(n, Bignumber.ROUND_HALF_UP).toNumber()\n}\n\n/**小数不足n位补零 */\nexport function zerofill(num: number | string, n = 2) {\n  const [intPart, decPart = ''] = String(num).split('.')\n  if (decPart.length >= n) return num\n  const filledDec = decPart.padEnd(n, '0').slice(0, n)\n  return `${intPart}.${filledDec}`\n}\n\n/**数字转换为百分比模式 */\nexport function toPercent(num: number | string) {\n  return multiply(num, 100) + '%'\n}\n\n/**判断是否是数字 */\nexport function isNumber(num: any): num is number {\n  const n = new Bignumber(num)\n  return n.isFinite() && !n.isNaN()\n}\n\n/**乘法 */\nexport function multiply(a: number | string, b: number | string) {\n  return new Bignumber(a).times(b).toNumber()\n}\n\n/**除法 */\nexport function divide(a: number | string, b: number | string) {\n  return new Bignumber(a).div(b).toNumber()\n}\n\n/**加法 */\nexport function add(a: number | string, b: number | string) {\n  return new Bignumber(a).plus(b).toNumber()\n}\n\n/**减法 */\nexport function subtract(a: number | string, b: number | string) {\n  return new Bignumber(a).minus(b).toNumber()\n}\n\n/**取余 */\nexport function mod(a: number | string, b: number | string) {\n  return new Bignumber(a).mod(b).toNumber()\n}\n","import { Form, type FormItemProps as AntdFormItemProps } from 'antd'\nimport { styled, type StyledComponent } from '@quick/cssinjs'\n\nconst StyledItem = styled(Form.Item) as StyledComponent<AntdFormItemProps>\ntype CompoundedComponent = typeof StyledItem & {\n  useStatus: typeof Form.Item.useStatus\n}\nconst Item = StyledItem as CompoundedComponent\nItem.useStatus = Form.Item.useStatus\n\nexport default Item\n","import { Form } from 'antd'\nimport { styled } from '@quick/cssinjs'\n\nconst ErrorList = styled(Form.ErrorList)\n\nexport default ErrorList\n","import { Form } from 'antd'\nimport { styled } from '@quick/cssinjs'\n\nconst Provider = styled(Form.Provider)\n\nexport default Provider\n","import { Form as AntdForm, type FormInstance, type FormProps as AntdFormProps } from 'antd'\nimport { styled, type StyledComponent } from '@quick/cssinjs'\nimport Item from './item'\nimport ErrorList from './error-list'\nimport Provider from './provider'\n\nconst { useForm, useFormInstance, useWatch } = AntdForm\n\nconst StyledForm = styled(AntdForm) as StyledComponent<AntdFormProps>\n\ntype CompoundedComponent = typeof StyledForm & {\n  Item: typeof Item\n  List: typeof AntdForm.List\n  ErrorList: typeof ErrorList\n  Provider: typeof Provider\n  useForm: typeof useForm\n  useFormInstance: typeof useFormInstance\n  useWatch: typeof useWatch\n}\n\nconst Form = StyledForm as CompoundedComponent\nForm.Item = Item\nForm.List = AntdForm.List\nForm.ErrorList = ErrorList\nForm.Provider = Provider\nForm.useForm = useForm\nForm.useFormInstance = useFormInstance\nForm.useWatch = useWatch\n\nexport type FormProps = React.ComponentProps<typeof StyledForm>\nexport type FormItemProps = React.ComponentProps<typeof Item>\nexport type FormListProps = React.ComponentProps<typeof AntdForm.List>\nexport type FormErrorListProps = React.ComponentProps<typeof ErrorList>\nexport type FormProviderProps = React.ComponentProps<typeof Provider>\nexport type { FormInstance }\n\nexport default Form\n","import { cloneElement, isValidElement } from 'react'\nimport dayjs, { Dayjs, isDayjs } from 'dayjs'\nimport { isNumber } from '@/utils'\nimport Form from '@/components/form'\n\ntype FormItemProps = React.ComponentProps<typeof Form.Item>\n\nexport interface SearchItemProps extends FormItemProps {\n  /**搜索项占据的列数 */\n  span?: number\n  /**日期类型值的转换格式，默认YYYY-MM-DD HH:mm:ss */\n  format?: string\n  /**以数组形式接受多个值 */\n  names?: string[]\n}\n\n// 判断是否是日期类型\nconst isDate = (value: string | undefined, format: string) => {\n  if (!value) return false\n  // YYYYMMDD这种格式则必须传入format来强制定义格式\n  if (isNumber(value)) {\n    return dayjs(value, format).isValid()\n  }\n  return dayjs(value).isValid()\n}\n\n// 字符串转换为日期格式\nconst parseDate = (value: (string | undefined) | (string | undefined)[], format: string) => {\n  if (!value) return value\n  if (Array.isArray(value)) {\n    return value.map(v => (v && isDate(v, format) ? dayjs(v) : v))\n  }\n  return isDate(value, format) ? dayjs(value) : value\n}\n\n// 日期格式化为字符串\nconst formatDate = (value: Dayjs | Dayjs[] | undefined, format: string) => {\n  if (!value) return value\n  if (Array.isArray(value)) {\n    return value.map(v => (isDayjs(v) ? v.format(format) : v))\n  }\n  return isDayjs(value) ? value.format(format) : value\n}\n\nconst getFormat = (format: string | undefined, child: any) => {\n  if (format) return format\n  if (child?.props?.showTime) return 'YYYY-MM-DD HH:mm:ss'\n  return 'YYYY-MM-DD'\n}\n\nexport default function Item({\n  span = 1,\n  name,\n  names,\n  format,\n  initialValue,\n  children,\n  ...props\n}: SearchItemProps) {\n  if (Array.isArray(initialValue) ? initialValue.some(i => isDayjs(i)) : isDayjs(initialValue)) {\n    throw new Error('Search.Item 不接收 dayjs 类型的初始值，请使用字符串格式化日期')\n  }\n\n  if (names) {\n    return (\n      <Form.Item style={{ gridColumn: `span ${span * 2}` }} {...props}>\n        {names.map((v, i) => (\n          <Form.Item key={v} name={v} hidden noStyle initialValue={initialValue?.[i]} />\n        ))}\n        <Form.Item\n          noStyle\n          shouldUpdate={(preVal, nextVal) => {\n            return names.some(n => preVal[n] !== nextVal[n])\n          }}\n        >\n          {props => {\n            const values = props.getFieldsValue(names)\n            const child = typeof children === 'function' ? children(props) : children\n            return isValidElement(child)\n              ? cloneElement<any>(child, {\n                  value: names.map(n => parseDate(values[n], getFormat(format, child))),\n                  onChange: (originalValue: any) => {\n                    const value = formatDate(originalValue, getFormat(format, child))\n                    props.setFieldsValue(\n                      names.reduce((acc, n, i) => ({ ...acc, [n]: value?.[i] }), {})\n                    )\n                  }\n                })\n              : child\n          }}\n        </Form.Item>\n      </Form.Item>\n    )\n  }\n\n  return (\n    <Form.Item\n      name={name}\n      initialValue={initialValue}\n      {...props}\n      // 将children的值存入form\n      getValueFromEvent={e => {\n        const value = e?.currentTarget?.value ?? e?.target?.value ?? e\n        return formatDate(value, getFormat(format, children))\n      }}\n      // 将form的值转换为children的值\n      getValueProps={value => ({\n        value: parseDate(value, getFormat(format, children))\n      })}\n    >\n      {children}\n    </Form.Item>\n  )\n}\n"]}