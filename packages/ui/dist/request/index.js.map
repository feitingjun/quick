{"version":3,"sources":["../../src/components/message/index.tsx","../../src/request/index.ts"],"names":["message"],"mappings":"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","file":"index.js","sourcesContent":["import { App } from 'antd'\nimport type { MessageInstance } from 'antd/es/message/interface'\n\nlet message: MessageInstance\n\nexport const useRegisterMessage = () => {\n  const { message: messageInstance } = App.useApp()\n  message = messageInstance\n  return null\n}\n\nexport { message }\n","import axios, { type ResponseType, type AxiosRequestConfig } from 'axios'\nimport { message } from '@/components/message'\n\ndeclare module 'axios' {\n  export interface AxiosRequestConfig {\n    skipErrorHandler?: boolean\n  }\n}\n\ninterface RequestInit {\n  /**请求基础路径 */\n  baseURL?: string\n  /**额外的请求头信息 */\n  headers?: Record<string, string>\n  /**请求超时时间 */\n  timeout?: number\n  /**响应数据格式，默认json */\n  responseType?: ResponseType\n  /**根据服务器返回数据自定义错误，返回null时表示没有错误 */\n  responseError?: (data: any) => string | null\n  /**为带数据请求功能的组件定义统一的response处理 */\n  internalResponseHandler?: {\n    all?: (data: any) => any\n    select?: (data: any) => Record<string, any>[]\n    page?: (data: any) => {\n      dataSource: Record<string, any>[]\n      total: number\n      pageSize: number\n      page: number\n    }\n  }\n}\n\nclass CustomError {\n  name: string\n  message: string\n  code = 'ERR_CUSTOM'\n  data: any\n  config: AxiosRequestConfig\n  constructor(message: string, data: any, config: AxiosRequestConfig) {\n    this.name = 'CustomError'\n    this.message = message\n    this.data = data\n    this.config = config\n  }\n}\n\n/**返回false时进入错误处理 */\naxios.defaults.validateStatus = status => {\n  return status >= 200 && status < 300\n}\n\n/**默认ResponseType */\naxios.defaults.responseType = 'json'\n\n/**响应拦截器 */\naxios.interceptors.response.use(\n  response => response.data,\n  error => {\n    let errorMsg = error.message || '未知错误'\n    let data = null\n    if (axios.isAxiosError(error)) {\n      errorMsg = error.message\n      data = error.response?.data\n    }\n    if (error instanceof CustomError) {\n      errorMsg = error.message\n      data = error.data\n    }\n    if (!error?.config?.skipErrorHandler) {\n      message.error(errorMsg)\n    }\n    return data\n  }\n)\n\nconst request = {\n  _internalResponseHandler: undefined as RequestInit['internalResponseHandler'],\n  /**初始化配置 */\n  init(config: RequestInit) {\n    axios.defaults.baseURL = config.baseURL\n    Object.entries(config.headers ?? {}).forEach(([key, value]) => {\n      axios.defaults.headers.common[key] = value\n    })\n    axios.defaults.timeout = config.timeout\n    axios.defaults.responseType = config.responseType ?? 'json'\n    this._internalResponseHandler = config?.internalResponseHandler\n    axios.defaults.transformResponse = [\n      ...(Array.isArray(axios.defaults.transformResponse)\n        ? axios.defaults.transformResponse\n        : axios.defaults.transformResponse\n        ? [axios.defaults.transformResponse]\n        : []),\n      function (data) {\n        const error = config.responseError?.(data)\n        if (error) {\n          throw new CustomError(error, data, this)\n        }\n        return data\n      }\n    ]\n  },\n  request: <T = any>(config: AxiosRequestConfig<T>) => axios.request<T, T | undefined>(config),\n  get: <T = any>(url: string, config?: AxiosRequestConfig<T>) =>\n    axios.get<T, T | undefined>(url, config),\n  post: <T = any>(url: string, data?: any, config?: AxiosRequestConfig<T>) =>\n    axios.post<T, T | undefined>(url, data, config),\n  put: <T = any>(url: string, data?: any, config?: AxiosRequestConfig<T>) =>\n    axios.put<T, T | undefined>(url, data, config),\n  delete: <T = any>(url: string, config?: AxiosRequestConfig<T>) =>\n    axios.delete<T, T | undefined>(url, config),\n  patch: <T = any>(url: string, data?: any, config?: AxiosRequestConfig<T>) =>\n    axios.patch<T, T | undefined>(url, data, config),\n  all: axios.all,\n  spread: axios.spread\n}\n\nexport default request\n"]}